!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("prop-types"),require("react-dom"),require("jquery")):"function"==typeof define&&define.amd?define(["react","prop-types","react-dom","jquery"],t):"object"==typeof exports?exports.SubItems=t(require("react"),require("prop-types"),require("react-dom"),require("jquery")):(e.eZ=e.eZ||{},e.eZ.modules=e.eZ.modules||{},e.eZ.modules.SubItems=t(e.React,e.PropTypes,e.ReactDOM,e.jQuery))}("undefined"!=typeof self?self:this,function(e,t,i,a){return function(e){var t={};function i(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=14)}([function(t,i){t.exports=e},function(e,i){e.exports=t},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(i(0)),s=n(i(1));function n(e){return e&&e.__esModule?e:{default:e}}const l=e=>{const t=e.customPath?e.customPath:`/bundles/ezplatformadminui/img/ez-icons.svg#${e.name}`;let i="ez-icon";return e.extraClasses&&(i=`${i} ${e.extraClasses}`),a.default.createElement("svg",{className:i},a.default.createElement("use",{xlinkHref:t}))};l.propTypes={extraClasses:s.default.string.isRequired,name:s.default.string,customPath:s.default.string},l.defaultProps={customPath:null,name:null},t.default=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getBasicRequestInit=(({token:e,siteaccess:t})=>({headers:{"X-Siteaccess":t,"X-CSRF-Token":e},mode:"same-origin",credentials:"same-origin"}));const a=t.handleRequestError=(e=>{if(!e.ok)throw Error(e.statusText);return e});t.handleRequestResponse=(e=>a(e).json()),t.handleRequestResponseStatus=(e=>a(e).status)},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=e=>{let t;if("object"!=typeof e)return e;if(!e)return e;if("[object Array]"===Object.prototype.toString.apply(e)){t=[];for(let i=0;i<e.length;i++)t[i]=a(e[i]);return t}t={};for(let i in e)e.hasOwnProperty(i)&&(t[i]=a(e[i]));return t};t.default=a},,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.headerLabels=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},s=i(0),n=c(s),l=c(i(1)),o=c(i(19)),r=c(i(20));function c(e){return e&&e.__esModule?e:{default:e}}const d="ContentName",u="DateModified",m="LocationPriority",p={[d]:"name",[u]:"date",[m]:"priority"},f="sub-items_columns-visibility",h={modified:!0,contentType:!0,priority:!0,translations:!0},b="c-table-view__cell",g=`${b} ${b}--head`,y=`${b} ${b}--sortable`,_=t.headerLabels={name:Translator.trans("items_table.header.name",{},"sub_items"),modified:Translator.trans("items_table.header.modified",{},"sub_items"),contentType:Translator.trans("items_table.header.content_type",{},"sub_items"),priority:Translator.trans("items_table.header.priority",{},"sub_items"),translations:Translator.trans("items_table.header.translations",{},"sub_items")};class v extends s.Component{constructor(e){super(e),this.sortByName=this.sortByName.bind(this),this.sortByDate=this.sortByDate.bind(this),this.sortByPriority=this.sortByPriority.bind(this),this.renderItem=this.renderItem.bind(this),this.selectAll=this.selectAll.bind(this),this.setColumnsVisibilityInLocalStorage=this.setColumnsVisibilityInLocalStorage.bind(this),this.toggleColumnVisibility=this.toggleColumnVisibility.bind(this),this._refColumnsTogglerButton=(0,s.createRef)(),this.state={columnsVisibility:this.getColumnsVisibilityFromLocalStorage()}}getColumnsVisibilityFromLocalStorage(){const e=localStorage.getItem(f);return e?JSON.parse(e):h}setColumnsVisibilityInLocalStorage(){const e=JSON.stringify(this.state.columnsVisibility);localStorage.setItem(f,e)}sortByName(){(0,this.props.onSortChange)(d)}sortByDate(){(0,this.props.onSortChange)(u)}sortByPriority(){(0,this.props.onSortChange)(m)}selectAll(e){(0,this.props.toggleAllItemsSelect)(e.target.checked)}toggleColumnVisibility(e){this.setState(t=>({columnsVisibility:a({},t.columnsVisibility,{[e]:!t.columnsVisibility[e]})}),this.setColumnsVisibilityInLocalStorage)}renderItem(e){const t=this.state.columnsVisibility;var i=this.props;const s=i.contentTypesMap,l=i.handleItemPriorityUpdate,r=i.handleEditItem,c=i.generateLink,d=i.languages,u=i.onItemSelect,m=i.selectedLocationsIds.has(e.location.id);return n.default.createElement(o.default,a({key:e.location.id},e,{contentTypesMap:s,onItemPriorityUpdate:l,languages:d,handleEditItem:r,generateLink:c,onItemSelect:u,isSelected:m,columnsVisibility:t}))}renderModifiedHeader(){return this.state.columnsVisibility.modified?n.default.createElement("th",{className:`${g} ${b}--date ${y}`,onClick:this.sortByDate,tabIndex:"-1"},n.default.createElement("span",{className:"c-table-view__label"},_.modified)):null}renderContentTypeHeader(){return this.state.columnsVisibility.contentType?n.default.createElement("th",{className:g},n.default.createElement("span",{className:"c-table-view__label"},_.contentType)):null}renderPriorityHeader(){return this.state.columnsVisibility.priority?n.default.createElement("th",{className:`${g} ${b}--priority ${y}`,onClick:this.sortByPriority,tabIndex:"-1"},n.default.createElement("span",{className:"c-table-view__label"},_.priority)):null}renderTranslationsHeader(){return this.state.columnsVisibility.translations?n.default.createElement("th",{className:`${g}`},n.default.createElement("span",{className:"c-table-view__label"},_.translations)):null}renderHead(){let e="c-table-view__head";if(!this.props.items.length)return null;var t=this.props;const i=t.sortClause,a=t.sortOrder;if(i){e=`${e} ${"ascending"===a?`${e}--sort-asc`:`${e}--sort-desc`} ${`${e}--sort-by-${p[i]}`}`}const s=this.state.columnsVisibility,l=!!this.props.selectedLocationsIds.size;return n.default.createElement("thead",{className:e},n.default.createElement("tr",{className:"c-table-view__row"},n.default.createElement("th",{className:`${g} c-table-view__cell--checkbox`},n.default.createElement("input",{type:"checkbox",checked:l,onChange:this.selectAll})),n.default.createElement("th",{className:g}),n.default.createElement("th",{className:`${g} ${b}--name ${y}`,onClick:this.sortByName,tabIndex:"-1"},n.default.createElement("span",{className:"c-table-view__label"},_.name)),this.renderModifiedHeader(),this.renderContentTypeHeader(),this.renderPriorityHeader(),this.renderTranslationsHeader(),n.default.createElement("th",{className:`${g} c-table-view__cell--actions`},n.default.createElement(r.default,{columnsVisibility:s,toggleColumnVisibility:this.toggleColumnVisibility}))))}render(){const e=this.props.items.map(this.renderItem);return n.default.createElement("div",{className:"c-table-view__wrapper"},n.default.createElement("div",{className:"c-table-view__scroller"},n.default.createElement("table",{className:"c-table-view"},this.renderHead(),n.default.createElement("tbody",{className:"c-table-view__body"},e))))}}t.default=v,v.propTypes={items:l.default.arrayOf(l.default.object).isRequired,contentTypesMap:l.default.object.isRequired,handleItemPriorityUpdate:l.default.func.isRequired,generateLink:l.default.func.isRequired,handleEditItem:l.default.func.isRequired,languages:l.default.object.isRequired,onItemSelect:l.default.func.isRequired,toggleAllItemsSelect:l.default.func.isRequired,selectedLocationsIds:l.default.instanceOf(Set),onSortChange:l.default.func.isRequired,sortClause:l.default.string.isRequired,sortOrder:l.default.string.isRequired}},,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},s=i(0),n=y(s),l=y(i(15)),o=y(i(1)),r=y(i(16)),c=y(i(18)),d=y(i(24)),u=y(i(26)),m=y(i(27)),p=y(i(29)),f=y(i(2)),h=y(i(5)),b=i(30),g=i(31);function y(e){return e&&e.__esModule?e:{default:e}}const _="ascending",v="descending",C=_;class w extends s.Component{constructor(e){super(e),this.afterPriorityUpdated=this.afterPriorityUpdated.bind(this),this.loadContentItems=this.loadContentItems.bind(this),this.loadContentTypes=this.loadContentTypes.bind(this),this.updateItemsState=this.updateItemsState.bind(this),this.switchView=this.switchView.bind(this),this.handleItemPriorityUpdate=this.handleItemPriorityUpdate.bind(this),this.toggleItemSelection=this.toggleItemSelection.bind(this),this.toggleAllPageItemsSelection=this.toggleAllPageItemsSelection.bind(this),this.onMoveBtnClick=this.onMoveBtnClick.bind(this),this.closeUdw=this.closeUdw.bind(this),this.onUdwConfirm=this.onUdwConfirm.bind(this),this.onDeleteBtnClick=this.onDeleteBtnClick.bind(this),this.closeBulkDeletePopup=this.closeBulkDeletePopup.bind(this),this.onBulkDeletePopupConfirm=this.onBulkDeletePopupConfirm.bind(this),this.afterBulkDelete=this.afterBulkDelete.bind(this),this.changePage=this.changePage.bind(this),this.changeSorting=this.changeSorting.bind(this),this._refListViewWrapper=n.default.createRef(),this.bulkDeleteModalContainer=null,this.udwContainer=null;const t=this.getDefaultSortClause(e.sortClauses);this.state={activeView:e.activeView,activePageItems:e.items,selectedItems:new Map,contentTypesMap:e.contentTypesMap,totalCount:e.totalCount,offset:e.offset,isDuringBulkOperation:!1,isUdwOpened:!1,isBulkDeletePopupVisible:!1,activePageIndex:0,listViewHeight:null,sortClause:t.name,sortOrder:t.order}}componentDidMount(){this.udwContainer=document.getElementById("react-udw"),this.bulkDeleteModalContainer=document.createElement("div"),this.bulkDeleteModalContainer.classList.add("m-sub-items__bulk-delete-modal-container"),document.body.appendChild(this.bulkDeleteModalContainer)}componentDidUpdate(){var e=this.state;const t=e.activePageIndex,i=e.activePageItems,a=e.totalCount,s=this.props.limit,n=Math.ceil(a/s);t>n-1&&0!==t?this.setState({activePageIndex:n-1}):!i&&this.loadPage(t)}componentWillUnmount(){document.body.removeChild(this.bulkDeleteModalContainer)}getDefaultSortClause(e){const t=Object.keys(e);if(!t.length)return{name:null,order:null};const i=t[0];return{name:i,order:e[i]}}updateListViewHeight(){this.setState(()=>({listViewHeight:this._refListViewWrapper.current.offsetHeight}))}loadPage(e){this.loadLocation(e).then(this.loadContentItems).then(this.loadContentTypes).then(this.updateItemsState).catch(()=>{const e=Translator.trans("page.loading_error.message",{},"sub_items");window.eZ.helpers.notification.showErrorNotification(e)})}loadLocation(e){var t=this.props;const i=t.limit,a=t.loadLocation,s=t.restInfo,n=t.parentLocationId;var l=this.state;const o={locationId:n,limit:i,sortClauses:{[l.sortClause]:l.sortOrder},offset:e*i};return new Promise(e=>a(s,o,e))}loadContentItems(e){var t=this.props;const i=t.loadContentInfo,a=t.restInfo;if(!e||!e.View){const e=Translator.trans("load_content_items.invalid_response_format.error.message",{},"sub_items");throw new Error(e)}const s=e.View.Result.searchHits.searchHit;return new Promise(t=>{const n=s.map(e=>e.value.Location.ContentInfo.Content._id);i(a,n,i=>{const a=e.View.Result.count;t({locations:s,totalCount:a,contentItems:i.View.Result.searchHits.searchHit.map(e=>e.value.Content)})})})}loadContentTypes(e){const t=e.contentItems.map(e=>new Promise(t=>{const i=e.ContentType._href;this.state.contentTypesMap[i]?t({ContentType:this.state.contentTypesMap[i]}):this.props.loadContentType(i,this.props.restInfo,e=>t(e))}));return Promise.all(t).then(t=>(e.contentTypes=t,e))}updateItemsState({locations:e,contentItems:t,totalCount:i,contentTypes:s}){const n=e.map(e=>{const i=e.value.Location,a=t.find(e=>e._id===i.ContentInfo.Content._id);return{location:i,content:a}});this.setState(e=>({activePageItems:n,totalCount:i,contentTypesMap:a({},e.contentTypesMap,this.buildContentTypesMap(s))}))}buildContentTypesMap(e){return e?e.reduce((e,t)=>(e[t.ContentType._href]=t.ContentType,e),{}):{}}updateTotalCountState(e){this.setState(()=>({totalCount:e}))}discardActivePageItems(){this.updateListViewHeight(),this.setState(()=>({activePageItems:null}))}changeSorting(e){this.updateListViewHeight(),this.setState(t=>({sortClause:e,sortOrder:this.getSortOrder(t.sortClause,e,t.sortOrder),activePageItems:null}))}getSortOrder(e,t,i){return t===e?this.getOppositeSortOrder(i):C}getOppositeSortOrder(e){return e===_?v:_}handleItemPriorityUpdate(e){this.props.updateLocationPriority(a({},e,this.props.restInfo),this.afterPriorityUpdated)}afterPriorityUpdated(e){"LocationPriority"!==this.state.sortClause?this.updateItemLocation(e.Location):this.discardActivePageItems()}updateItemLocation(e){this.setState(({activePageItems:t})=>{const i=t.findIndex(t=>t.location.id===e.id);if(-1===i)return null;const a=t[i],s=(0,h.default)(a),n=[...t];return s.location=e,n[i]=s,{activePageItems:n}})}switchView(e){this.setState(()=>({activeView:e}))}toggleItemSelection(e,t){const i=this.state.selectedItems,a=new Map(i),s=e.location.id;t?a.set(s,e):a.delete(s),this.setState(()=>({selectedItems:a}))}toggleAllPageItemsSelection(e){const t=this.state.activePageItems;if(e)this.selectItems(t);else{const e=t.map(e=>e.location.id),i=new Set(e);this.deselectItems(i)}}selectItems(e){const t=this.state.selectedItems,i=e.map(e=>[e.location.id,e]),a=new Map([...t,...i]);this.setState(()=>({selectedItems:a}))}deselectItems(e){const t=this.state.selectedItems,i=new Map([...t].filter(([t])=>!e.has(t)));this.setState(()=>({selectedItems:i}))}deselectAllItems(){this.setState(()=>({selectedItems:new Map}))}toggleBulkOperationStatusState(e){this.setState(()=>({isDuringBulkOperation:e}))}onMoveBtnClick(){this.toggleUdw(!0)}bulkMove(e){this.toggleBulkOperationStatusState(!0);const t=this.props.restInfo,i=this.state.selectedItems,a=[...i.values()].map(({location:e})=>e);(0,g.bulkMoveLocations)(t,a,e._href,this.afterBulkMove.bind(this,i,e))}afterBulkMove(e,t,i,a){const s=this.state.totalCount;if(this.updateTotalCountState(s-i.length),this.deselectAllItems(),this.discardActivePageItems(),this.toggleBulkOperationStatusState(!1),a.length){const t=Translator.trans("bulk_move.error.modal.table_title",{itemsCount:a.length},"sub_items"),s=Translator.trans("bulk_move.error.message",{notMovedCount:a.length,totalCount:i.length+a.length},"sub_items");this.handleBulkOperationFailedNotification(e,a,t,s)}if(i.length){const e=Translator.trans("bulk_move.success.message",{locationName:t.ContentInfo.Content.Name,locationHref:this.props.generateLink(t.id)},"sub_items");window.eZ.helpers.notification.showSuccessNotification(e)}}toggleUdw(e){this.setState(()=>({isUdwOpened:e}))}closeUdw(){this.toggleUdw(!1)}onUdwConfirm([e]){this.closeUdw(),this.bulkMove(e)}renderUdw(){if(!this.state.isUdwOpened)return null;const e=window.eZ.modules.UniversalDiscovery;var t=this.props;const i=t.restInfo,s=t.parentLocationId,o=t.udwConfigBulkMoveItems,r=[s,...[...this.state.selectedItems.values()].map(({location:e})=>e.id)],c=Translator.trans("udw.choose_location.title",{},"sub_items"),d=a({title:c,restInfo:i,onCancel:this.closeUdw,onConfirm:this.onUdwConfirm,canSelectContent:({item:e},t)=>{t(!r.includes(e.id))}},o);return l.default.createPortal(n.default.createElement(e,d),this.udwContainer)}onDeleteBtnClick(){this.toggleBulkDeletePopup(!0)}bulkDelete(){this.toggleBulkOperationStatusState(!0);const e=this.props.restInfo,t=this.state.selectedItems,i=[...t.values()].map(({location:e})=>e);(0,g.bulkMoveLocationsToTrash)(e,i,this.afterBulkDelete.bind(this,t))}afterBulkDelete(e,t,i){const a=this.state.totalCount;if(this.updateTotalCountState(a-t.length),this.deselectAllItems(),this.discardActivePageItems(),this.toggleBulkOperationStatusState(!1),i.length){const a=Translator.trans("bulk_delete.error.modal.table_title",{itemsCount:i.length},"sub_items"),s=Translator.trans("bulk_delete.error.message",{notDeletedCount:i.length,totalCount:t.length+i.length},"sub_items");this.handleBulkOperationFailedNotification(e,i,a,s)}else{const e=Translator.trans("bulk_delete.success.message",{},"sub_items");window.eZ.helpers.notification.showSuccessNotification(e)}}toggleBulkDeletePopup(e){this.setState(()=>({isBulkDeletePopupVisible:e}))}closeBulkDeletePopup(){this.toggleBulkDeletePopup(!1)}onBulkDeletePopupConfirm(){this.closeBulkDeletePopup(),this.bulkDelete()}handleBulkOperationFailedNotification(e,t,i,a){const s=this.state.contentTypesMap,n=t.map(({id:t})=>{const i=e.get(t),a=s[i.content.ContentType._href].identifier;return{contentTypeName:window.eZ.adminUiConfig.contentTypeNames[a],contentName:i.content.Name}});window.eZ.helpers.notification.showWarningNotification(a,e=>{const t=e.querySelector(".ez-notification-btn--show-modal");t&&t.addEventListener("click",this.props.showBulkActionFailedModal.bind(null,i,n))})}renderConfirmationPopupFooter(){const e=Translator.trans("bulk_delete.popup.cancel",{},"sub_items"),t=Translator.trans("bulk_delete.popup.confirm",{},"sub_items");return n.default.createElement(s.Fragment,null,n.default.createElement("button",{onClick:this.closeBulkDeletePopup,type:"button",className:"btn btn-secondary btn--no m-sub-items__confirmation-modal-cancel-btn","data-dismiss":"modal"},e),n.default.createElement("button",{onClick:this.onBulkDeletePopupConfirm,type:"button",className:"btn btn-danger font-weight-bold btn--trigger"},t))}renderConfirmationPopup(){const e=this.state.isBulkDeletePopupVisible;if(!e)return null;const t=Translator.trans("bulk_delete.popup.message",{},"sub_items");return l.default.createPortal(n.default.createElement(d.default,{onClose:this.closeBulkDeletePopup,isVisible:e,isLoading:!1,size:"medium",footerChildren:this.renderConfirmationPopupFooter(),noHeader:!0},n.default.createElement("div",{className:"m-sub-items__confirmation-modal-body"},t)),this.bulkDeleteModalContainer)}changePage(e){this.updateListViewHeight(),this.setState(()=>({activePageIndex:e,activePageItems:null}))}getPageSelectedLocationsIds(){var e=this.state;const t=e.selectedItems,i=e.activePageItems,a=[...t.keys()],s=[...i.map(e=>e.location.id)];return new Set(s.filter(e=>a.includes(e)))}renderExtraActions(e,t){const i=e.component;return n.default.createElement(i,a({key:t,className:"m-sub-items__action"},e.attrs))}renderPaginationInfo(){var e=this.state;const t=e.totalCount,i=e.activePageItems,a=i?i.length:0,s=Translator.trans("viewing_message",{viewingCount:a,totalCount:t},"sub_items");return n.default.createElement("div",{className:"m-sub-items__pagination-info",dangerouslySetInnerHTML:{__html:s}})}renderPagination(){const e=this.props.limit,t=this.state.totalCount;if(t<=e)return null;var i=this.state;const a=i.activePageIndex,s=i.activePageItems,l=i.isDuringBulkOperation,o=!!!s||l;return n.default.createElement(m.default,{proximity:1,itemsPerPage:e,activePageIndex:a,totalCount:t,onPageChange:this.changePage,disabled:o})}renderBulkMoveBtn(e){const t=Translator.trans("move_btn.label",{},"sub_items");return n.default.createElement(u.default,{disabled:e,onClick:this.onMoveBtnClick,label:t,type:"move"})}renderBulkDeleteBtn(e){const t=Translator.trans("trash_btn.label",{},"sub_items");return n.default.createElement(u.default,{disabled:e,onClick:this.onDeleteBtnClick,label:t,type:"trash"})}renderSpinner(){if(!!this.state.activePageItems)return null;const e=this.state.listViewHeight,t={height:e&&e>90?e:90};return n.default.createElement("div",{style:t},n.default.createElement("div",{className:"m-sub-items__spinner-wrapper"},n.default.createElement(f.default,{name:"spinner",extraClasses:"m-sub-items__spinner ez-icon--medium ez-spin"})))}renderNoItems(){return this.state.totalCount?null:n.default.createElement(p.default,null)}renderListView(){var e=this.state;const t=e.activePageItems,i=e.sortClause,a=e.sortOrder;if(!!!t)return null;const s=this.getPageSelectedLocationsIds();return n.default.createElement(c.default,{activeView:this.state.activeView,contentTypesMap:this.state.contentTypesMap,handleItemPriorityUpdate:this.handleItemPriorityUpdate,items:t,languages:this.props.languages,handleEditItem:this.props.handleEditItem,generateLink:this.props.generateLink,onItemSelect:this.toggleItemSelection,toggleAllItemsSelect:this.toggleAllPageItemsSelection,selectedLocationsIds:s,onSortChange:this.changeSorting,sortClause:i,sortOrder:a})}render(){const e=Translator.trans("items_list.title",{},"sub_items");var t=this.state;const i=t.selectedItems,a=t.activeView,s=t.totalCount,l=t.isDuringBulkOperation,o=t.activePageItems,c=!i.size||!("table"===a)||!!!o;let d="m-sub-items__list";return l&&(d=`${d} ${d}--processing`),n.default.createElement("div",{className:"m-sub-items"},n.default.createElement("div",{className:"m-sub-items__header"},n.default.createElement("div",{className:"m-sub-items__title"},e," (",this.state.totalCount,")"),n.default.createElement("div",{className:"m-sub-items__actions"},this.props.extraActions.map(this.renderExtraActions),this.renderBulkMoveBtn(c),this.renderBulkDeleteBtn(c)),n.default.createElement(r.default,{onViewChange:this.switchView,activeView:a,isDisabled:!s})),n.default.createElement("div",{ref:this._refListViewWrapper,className:d},this.renderSpinner(),this.renderListView(),this.renderNoItems()),this.renderPaginationInfo(),this.renderPagination(),this.renderUdw(),this.renderConfirmationPopup())}}t.default=w,eZ.addConfig("modules.SubItems",w),w.propTypes={parentLocationId:o.default.number.isRequired,restInfo:o.default.shape({token:o.default.string.isRequired,siteaccess:o.default.string.isRequired}).isRequired,loadContentInfo:o.default.func,loadContentType:o.default.func,loadContentTypes:o.default.func,loadLocation:o.default.func,sortClauses:o.default.object,updateLocationPriority:o.default.func,activeView:o.default.string,extraActions:o.default.arrayOf(o.default.shape({component:o.default.func,attrs:o.default.object})),items:o.default.arrayOf(o.default.object),limit:o.default.number,offset:o.default.number,handleEditItem:o.default.func.isRequired,generateLink:o.default.func.isRequired,contentTypesMap:o.default.object,totalCount:o.default.number,languages:o.default.object,udwConfigBulkMoveItems:o.default.object.isRequired,showBulkActionFailedModal:o.default.func.isRequired},w.defaultProps={loadContentInfo:b.loadContentInfo,loadContentType:b.loadContentType,loadContentTypes:b.loadContentTypes,loadLocation:b.loadLocation,sortClauses:{},updateLocationPriority:b.updateLocationPriority,activeView:"table",extraActions:[],languages:window.eZ.adminUiConfig.languages,items:[],limit:parseInt(window.eZ.adminUiConfig.subItems.limit,10),offset:0,contentTypesMap:{},totalCount:0}},function(e,t){e.exports=i},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(i(0)),s=l(i(1)),n=l(i(17));function l(e){return e&&e.__esModule?e:{default:e}}const o=({onViewChange:e,activeView:t,isDisabled:i})=>{let s="c-view-switcher";i&&(s=`${s} ${s}--disabled`);const l=Translator.trans("switch_to_list_view.btn.label",{},"sub_items"),o=Translator.trans("switch_to_grid_view.btn.label",{},"sub_items");return a.default.createElement("div",{className:s},a.default.createElement(n.default,{id:"table",icon:"view-list",title:l,onClick:e,activeView:t,isDisabled:i}),a.default.createElement(n.default,{id:"grid",icon:"view-grid",title:o,onClick:e,activeView:t,isDisabled:i}))};o.propTypes={onViewChange:s.default.func.isRequired,activeView:s.default.string.isRequired,isDisabled:s.default.bool.isRequired},t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(i(0)),s=l(i(1)),n=l(i(2));function l(e){return e&&e.__esModule?e:{default:e}}const o=({id:e,icon:t,title:i,onClick:s,activeView:l,isDisabled:o})=>{const r={id:e,onClick:()=>s(e),className:"c-view-switcher-btn",title:i,tabIndex:"-1"},c={name:t,extraClasses:"ez-icon--secondary ez-icon--small"};return l===e&&(r.className="c-view-switcher-btn c-view-switcher-btn--active",c.extraClasses="ez-icon--light ez-icon--small"),o&&(r.className=`${r.className} c-view-switcher-btn--disabled`),a.default.createElement("div",r,a.default.createElement(n.default,c))};o.propTypes={id:s.default.string.isRequired,activeView:s.default.string.isRequired,isDisabled:s.default.bool.isRequired,icon:s.default.string.isRequired,title:s.default.string.isRequired,onClick:s.default.func.isRequired},t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(i(0)),s=o(i(1)),n=o(i(9)),l=o(i(22));function o(e){return e&&e.__esModule?e:{default:e}}const r={table:n.default,grid:l.default},c=e=>{const t=r[e.activeView];return a.default.createElement(t,e)};c.propTypes={activeView:s.default.string.isRequired,items:s.default.arrayOf(s.default.object),contentTypesMap:s.default.object.isRequired,handleItemPriorityUpdate:s.default.func.isRequired,languages:s.default.object.isRequired,onItemSelect:s.default.func.isRequired,toggleAllItemsSelect:s.default.func.isRequired,selectedLocationsIds:s.default.instanceOf(Set).isRequired,onSortChange:s.default.func.isRequired,sortClause:s.default.string.isRequired,sortOrder:s.default.string.isRequired},t.default=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},s=i(0),n=r(s),l=r(i(1)),o=r(i(2));function r(e){return e&&e.__esModule?e:{default:e}}class c extends s.PureComponent{constructor(e){super(e),this.storePriorityValue=this.storePriorityValue.bind(this),this.enablePriorityInput=this.enablePriorityInput.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleEdit=this.handleEdit.bind(this),this.onSelectCheckboxChange=this.onSelectCheckboxChange.bind(this),this.setPriorityInputRef=this.setPriorityInputRef.bind(this),this._refPriorityInput=null,this.state={priorityValue:e.location.priority,priorityInputEnabled:!1,startingPriorityValue:e.location.priority}}enablePriorityInput(){this.setState(()=>({priorityInputEnabled:!0}))}handleCancel(e){e.preventDefault(),this.setState(e=>({priorityInputEnabled:!1,priorityValue:e.startingPriorityValue}))}handleSubmit(e){e.preventDefault(),this.props.onItemPriorityUpdate({location:this.props.location._href,priority:this._refPriorityInput.value}),this.setState(()=>({priorityValue:this._refPriorityInput.value,priorityInputEnabled:!1,startingPriorityValue:this._refPriorityInput.value}))}storePriorityValue(e){e.preventDefault(),this.setState(()=>({priorityValue:this._refPriorityInput.value}))}handleEdit(){this.props.handleEditItem(this.props.content)}setPriorityInputRef(e){this._refPriorityInput=e}renderPriorityCell(){const e={type:"number",defaultValue:this.state.priorityValue,onChange:this.storePriorityValue},t={},i={};return this.props.columnsVisibility.priority?(this.state.priorityInputEnabled||(e.disabled=!0,delete e.defaultValue,e.value=this.state.priorityValue,t.onClick=this.enablePriorityInput,t.className="c-table-view-item__inner-wrapper c-table-view-item__inner-wrapper--disabled",i.hidden=!0),n.default.createElement("td",{className:"c-table-view-item__cell c-table-view-item__cell--priority"},n.default.createElement("div",a({className:"c-table-view-item__priority-wrapper"},t),n.default.createElement("div",{className:"c-table-view-item__inner-wrapper c-table-view-item__inner-wrapper--input"},n.default.createElement("input",a({className:"c-table-view-item__priority-value",ref:this.setPriorityInputRef},e))),n.default.createElement("div",a({className:"c-table-view-item__priority-actions"},i),n.default.createElement("button",{type:"button",className:"c-table-view-item__btn c-table-view-item__btn--cancel",onClick:this.handleCancel},n.default.createElement(o.default,{name:"discard",extraClasses:"ez-icon--medium ez-icon--light"})),n.default.createElement("button",{type:"button",className:"c-table-view-item__btn c-table-view-item__btn--submit",onClick:this.handleSubmit},n.default.createElement(o.default,{name:"checkmark",extraClasses:"ez-icon--medium ez-icon--light"})))))):null}renderModifiedCell(){if(!this.props.columnsVisibility.modified)return null;const e=this.props.content,t=window.eZ.helpers.timezone.formatShortDateWithTimezone;return n.default.createElement("td",{className:"c-table-view-item__cell c-table-view-item__cell--modified"},n.default.createElement("div",{className:"c-table-view-item__text-wrapper"},t(new Date(e.lastModificationDate))))}renderContentTypeCell(){if(!this.props.columnsVisibility.contentType)return null;var e=this.props;const t=e.content,i=e.contentTypesMap,a=Translator.trans("content_type.not_available.label",{},"sub_items"),s=i[t.ContentType._href],l=s?s.identifier:null,o=l?window.eZ.adminUiConfig.contentTypeNames[l]:a;return n.default.createElement("td",{className:"c-table-view-item__cell c-table-view-item__cell--content-type"},n.default.createElement("div",{className:"c-table-view-item__text-wrapper"},o))}renderTranslationsCell(){if(!this.props.columnsVisibility.translations)return null;var e=this.props;const t=e.content,i=e.languages,a=t.CurrentVersion.Version.VersionInfo.VersionTranslationInfo.Language.map(e=>i.mappings[e.languageCode].name);return n.default.createElement("td",{className:"c-table-view-item__cell c-table-view-item__cell--translations"},a.map(this.renderTranslation))}renderTranslation(e,t){return n.default.createElement("span",{key:t,className:"c-table-view-item__translation"},e)}onSelectCheckboxChange(e){var t=this.props;const i=t.location,a=t.content;(0,t.onItemSelect)({content:a,location:i},e.target.checked)}render(){var e=this.props;const t=e.content,i=e.location,a=e.isSelected,s=e.contentTypesMap,l=e.generateLink,r=Translator.trans("edit_item_btn.label",{},"sub_items"),c=s[t.ContentType._href],d=c?c.identifier:null,u={className:"c-table-view-item__link c-table-view-item__text-wrapper",title:t.Name,href:l(i.id)},m=eZ.helpers.contentType.getContentTypeIconUrl(d);return n.default.createElement("tr",{className:"c-table-view-item"},n.default.createElement("td",{className:"c-table-view-item__cell c-table-view-item__cell--checkbox"},n.default.createElement("input",{type:"checkbox",checked:a,onChange:this.onSelectCheckboxChange})),n.default.createElement("td",{className:"c-table-view-item__cell c-table-view-item__cell--icon"},n.default.createElement(o.default,{customPath:m,extraClasses:"ez-icon--small"})),n.default.createElement("td",{className:"c-table-view-item__cell c-table-view-item__cell--name"},n.default.createElement("a",u,t.Name)),this.renderModifiedCell(),this.renderContentTypeCell(),this.renderPriorityCell(),this.renderTranslationsCell(),n.default.createElement("td",{className:"c-table-view-item__cell c-table-view-item__cell--actions"},n.default.createElement("span",{title:r,onClick:this.handleEdit,className:"c-table-view-item__btn c-table-view-item__btn--edit",tabIndex:"-1"},n.default.createElement("div",{className:"c-table-view-item__btn-inner"},n.default.createElement(o.default,{name:"edit",extraClasses:"ez-icon--medium"})))))}}t.default=c,c.propTypes={content:l.default.object.isRequired,location:l.default.object.isRequired,isSelected:l.default.bool.isRequired,contentTypesMap:l.default.object.isRequired,onItemPriorityUpdate:l.default.func.isRequired,handleEditItem:l.default.func.isRequired,generateLink:l.default.func.isRequired,languages:l.default.object.isRequired,onItemSelect:l.default.func.isRequired,columnsVisibility:l.default.object.isRequired}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),s=c(a),n=c(i(1)),l=c(i(2)),o=c(i(21)),r=i(9);function c(e){return e&&e.__esModule?e:{default:e}}const d=200;class u extends a.Component{constructor(e){super(e),this.togglePanel=this.togglePanel.bind(this),this.hidePanel=this.hidePanel.bind(this),this._refTogglerButton=(0,a.createRef)(),this._refPanel=(0,a.createRef)(),this.state={isOpen:!1,buttonBottomDocumentOffset:null,panelHeight:null}}componentDidMount(){document.addEventListener("click",this.hidePanel,!1),this.setState(()=>({buttonBottomDocumentOffset:this.getBtnBottomDocumentOffset()}))}componentDidUpdate(){var e=this.state;const t=e.isOpen,i=e.panelHeight;t&&null===i&&this.setState({panelHeight:this._refPanel.offsetHeight})}componentWillUnmount(){document.removeEventListener("click",this.hidePanel)}getBtnBottomDocumentOffset(){const e=this._refTogglerButton.current.getBoundingClientRect().top+window.scrollY;return document.documentElement.scrollHeight-e}hidePanel({target:e}){if(!this.state.isOpen)return;e.closest(".c-table-view-columns-toggler")||this.setState(()=>({isOpen:!1}))}togglePanel(){this.setState(e=>({isOpen:!e.isOpen}))}renderPanel(){if(!this.state.isOpen)return null;var e=this.props;const t=e.columnsVisibility,i=e.toggleColumnVisibility;var a=this.state;const n=a.buttonBottomDocumentOffset,l=a.panelHeight,c=l||d,u={className:"c-table-view-columns-toggler__panel",ref:this._refPanel};return n<c&&(u.className=`${u.className} ${u.className}--above-btn`),s.default.createElement("div",u,s.default.createElement("ul",{className:"c-table-view-columns-toggler__list"},Object.entries(t).map(([e,t])=>{const a=r.headerLabels[e];return s.default.createElement(o.default,{key:e,label:a,columnKey:e,isColumnVisible:t,toggleColumnVisibility:i})})))}render(){return s.default.createElement("div",{className:"c-table-view-columns-toggler"},s.default.createElement("button",{ref:this._refTogglerButton,type:"button",className:"btn btn-dark c-table-view-columns-toggler__btn",onClick:this.togglePanel},s.default.createElement(l.default,{name:"filters",extraClasses:"ez-icon--small ez-icon--light"})),this.renderPanel())}}t.default=u,u.propTypes={columnsVisibility:n.default.object.isRequired,toggleColumnVisibility:n.default.func.isRequired}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(i(0)),s=n(i(1));function n(e){return e&&e.__esModule?e:{default:e}}const l=({label:e,isColumnVisible:t,toggleColumnVisibility:i,columnKey:s})=>a.default.createElement("li",{className:"c-table-view-columns-toggler-list-element",onClick:()=>i(s)},a.default.createElement("div",{className:"form-check form-check-inline"},a.default.createElement("input",{className:"form-check-input",type:"checkbox",checked:t,readOnly:!0}),a.default.createElement("label",{className:"c-table-view-columns-toggler-list-element__label form-check-label"},e)));l.propTypes={label:s.default.string.isRequired,columnKey:s.default.string.isRequired,isColumnVisible:s.default.bool.isRequired,toggleColumnVisibility:s.default.func.isRequired},t.default=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},s=o(i(0)),n=o(i(1)),l=o(i(23));function o(e){return e&&e.__esModule?e:{default:e}}const r=e=>{const t=e.items,i=e.contentTypesMap,n=e.generateLink;return s.default.createElement("div",{className:"c-grid-view"},t.map(e=>s.default.createElement(l.default,a({key:e.location.id},e,{contentTypesMap:i,generateLink:n}))))};r.propTypes={items:n.default.arrayOf(n.default.object),contentTypesMap:n.default.object,generateLink:n.default.func.isRequired},t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(i(0)),s=l(i(1)),n=l(i(2));function l(e){return e&&e.__esModule?e:{default:e}}const o=({content:e,location:t,generateLink:i,contentTypesMap:s})=>{const l=e.CurrentVersion.Version.Fields.field.find(e=>"ezimage"===e.fieldTypeIdentifier),o=l&&l.fieldValue&&l.fieldValue.uri&&l.fieldValue.path,r=s?s[e.ContentType._href]:null,c=r?r.identifier:null,d=eZ.helpers.contentType.getContentTypeIconUrl(c);let u=a.default.createElement("div",{className:"c-grid-view-item__image c-grid-view-item__image--none"},a.default.createElement(n.default,{customPath:d,extraClasses:"ez-icon--extra-large"})),m="";return o&&(u=a.default.createElement("img",{className:"c-grid-view-item__image",src:l.fieldValue.uri,alt:`${l.fieldValue.path}`}),m=a.default.createElement("div",{className:"c-grid-view-item__content-type"},a.default.createElement(n.default,{customPath:d,extraClasses:"ez-icon--small"}))),a.default.createElement("a",{className:"c-grid-view-item",href:i(t.id)},m,a.default.createElement("div",{className:"c-grid-view-item__image-wrapper"},u),a.default.createElement("div",{className:"c-grid-view-item__title"},e.Name))};o.propTypes={content:s.default.object.isRequired,location:s.default.object.isRequired,contentTypesMap:s.default.object.isRequired,generateLink:s.default.func.isRequired},t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},s=i(0),n=c(s),l=c(i(25)),o=c(i(1)),r=c(i(2));function c(e){return e&&e.__esModule?e:{default:e}}const d="ezs-non-scrollable",u="modal-open",m={backdrop:"static",keyboard:!0},p={small:"modal-sm",medium:"",large:"modal-lg"};class f extends s.Component{constructor(e){super(e),this._refModal=null,this.setModalRef=this.setModalRef.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.state={isVisible:e.isVisible,isLoading:e.isLoading}}componentDidMount(){const e=this.state.isVisible;e&&((0,l.default)(this._refModal).modal(a({},m,{show:e,focus:this.props.hasFocus})),this.attachModalEventHandlers())}componentDidUpdate(){const e=this.state.isVisible;(0,l.default)(this._refModal).modal(a({},m,{show:e,focus:this.props.hasFocus})),e&&this.attachModalEventHandlers()}componentWillUnmount(){(0,l.default)(this._refModal).modal("hide"),document.body.classList.remove(u,d)}UNSAFE_componentWillReceiveProps({isVisible:e,onConfigIframeLoad:t,isLoading:i}){this.setState(s=>a({},s,{isVisible:e,onConfigIframeLoad:t,isLoading:i}))}attachModalEventHandlers(){const e=(0,l.default)(this._refModal);e.on("keyup",this.onKeyUp),e.one("hidden.bs.modal",this.props.onClose)}onKeyUp(e){const t=e.originalEvent;t&&(27===t.which||27===t.keyCode)&&this.props.onClose()}setModalRef(e){this._refModal=e}renderHeader(){const e=Translator.trans("popup.close.label",{},"universal_discovery_widget");return n.default.createElement("div",{className:"modal-header c-popup__header"},this.renderHeadline(),n.default.createElement("button",{type:"button",className:"close c-popup__btn--close","data-dismiss":"modal","aria-label":e,onClick:this.props.onClose},n.default.createElement(r.default,{name:"discard",extraClasses:"ez-icon--medium"})))}renderHeadline(){return this.props.title?n.default.createElement("h3",{className:"modal-title c-popup__headline",title:this.props.title},n.default.createElement("span",{className:"c-popup__title"},this.props.title),this.renderSubtitle()):null}renderSubtitle(){const e=this.props.subtitle;return e?n.default.createElement("span",{className:"c-popup__subtitle"},e):null}renderFooter(){const e=this.props.footerChildren;if(e)return n.default.createElement("div",{className:"modal-footer c-popup__footer"},e)}render(){const e=this.state.isVisible;var t=this.props;const i=t.additionalClasses,a=t.size,s=t.noHeader,l={className:"c-popup modal fade",ref:this.setModalRef,tabIndex:this.props.hasFocus?-1:void 0};return document.body.classList.toggle(u,e),document.body.classList.toggle(d,e),i&&(l.className=`${l.className} ${i}`),s&&(l.className=`${l.className} c-popup--no-header`),n.default.createElement("div",l,n.default.createElement("div",{className:`modal-dialog c-popup__dialog ${p[a]}`,role:"dialog"},n.default.createElement("div",{className:"modal-content c-popup__content"},this.renderHeader(),n.default.createElement("div",{className:"modal-body c-popup__body"},this.props.children),this.renderFooter())))}}f.propTypes={isVisible:o.default.bool,isLoading:o.default.bool,onClose:o.default.func.isRequired,onConfigIframeLoad:o.default.func,children:o.default.element.isRequired,title:o.default.string,subtitle:o.default.string,hasFocus:o.default.bool,additionalClasses:o.default.string,footerChildren:o.default.element,size:o.default.string,noHeader:o.default.bool},f.defaultProps={isVisible:!1,isLoading:!0,hasFocus:!0,size:"large",noHeader:!1,onConfigIframeLoad:()=>{}},t.default=f},function(e,t){e.exports=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(i(0)),s=l(i(1)),n=l(i(2));function l(e){return e&&e.__esModule?e:{default:e}}const o=e=>{const t=e.disabled,i=e.onClick,s=e.label,l=e.type,o={className:"c-action-btn",title:s,tabIndex:"-1",onClick:()=>{t||i()}};return o.className=t?`${o.className} c-action-btn--disabled`:o.className,o.className=l?`${o.className} c-action-btn--${l}`:o.className,a.default.createElement("div",o,a.default.createElement(n.default,{name:l,extraClasses:"ez-icon--light ez-icon--medium"}))};o.propTypes={label:s.default.string.isRequired,disabled:s.default.bool.isRequired,type:s.default.string.isRequired,onClick:s.default.func.isRequired},t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(i(0)),s=l(i(1)),n=l(i(28));function l(e){return e&&e.__esModule?e:{default:e}}const o=({totalCount:e,itemsPerPage:t,proximity:i,activePageIndex:s,onPageChange:l,disabled:o})=>{const r=Math.ceil(e/t),c=Translator.trans("pagination.back",{},"sub_items"),d=Translator.trans("pagination.next",{},"sub_items"),u=s-1,m=s+1,p=0===s,f=s+1===r,h=(({proximity:e,activePageIndex:t,pagesCount:i})=>{const a=[];let s=!1;for(let n=1;n<=i;n++)1===n||n===i||n>=t+1-e&&n<=t+1+e?(a.push(n),s=!1):s||(a.push("..."),s=!0);return a})({proximity:i,activePageIndex:s,pagesCount:r}).map((e,t)=>{if("..."===e)return a.default.createElement(n.default,{key:`dots-${t}`,label:"...",disabled:!0});const i=e===s+1?"active":"",r=""+e;return a.default.createElement(n.default,{key:e,pageIndex:e-1,label:r,additionalClasses:i,onPageChange:l,disabled:o})});return a.default.createElement("ul",{className:"c-pagination pagination row justify-content-center"},a.default.createElement(n.default,{pageIndex:u,label:c,additionalClasses:"prev",disabled:p||o,onPageChange:l}),h,a.default.createElement(n.default,{pageIndex:m,label:d,additionalClasses:"next",disabled:f||o,onPageChange:l}))};o.propTypes={proximity:s.default.number.isRequired,itemsPerPage:s.default.number.isRequired,activePageIndex:s.default.number.isRequired,totalCount:s.default.number.isRequired,onPageChange:s.default.func.isRequired,disabled:s.default.bool},t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(i(0)),s=n(i(1));function n(e){return e&&e.__esModule?e:{default:e}}const l=({label:e,disabled:t,additionalClasses:i,onPageChange:s,pageIndex:n})=>{let l=`c-pagination-button page-item ${i}`;return l=t?`${l} disabled`:l,a.default.createElement("li",{className:l},a.default.createElement("button",{className:"page-link",onClick:()=>{!t&&Number.isInteger(n)&&s(n)},type:"button"},e))};l.propTypes={label:s.default.string.isRequired,disabled:s.default.bool,onPageChange:s.default.func,pageIndex:s.default.number,additionalClasses:s.default.string},l.defaultProps={disabled:!1,additionalClasses:"",onPageChange:()=>{}},t.default=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(i(0));t.default=(()=>{const e=Translator.trans("no_items.message",{},"sub_items");return a.default.createElement("div",{className:"c-no-items"},e)})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateLocationPriority=t.loadContentType=t.loadContentTypes=t.loadContentInfo=t.loadLocation=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},s=i(3);const n={Accept:"application/vnd.ez.api.View+json; version=1.1","Content-Type":"application/vnd.ez.api.ViewInput+json; version=1.1"};t.loadLocation=(({token:e,siteaccess:t},{locationId:i=2,limit:l=10,offset:o=0,sortClauses:r},c)=>{const d=JSON.stringify({ViewInput:{identifier:`subitems-load-location-${i}`,public:!1,LocationQuery:{Criteria:{},FacetBuilders:{},SortClauses:r,Filter:{ParentLocationIdCriterion:i},limit:l,offset:o}}}),u=new Request("/api/ezp/v2/views",{method:"POST",headers:a({},n,{"X-Siteaccess":t,"X-CSRF-Token":e}),body:d,mode:"cors",credentials:"same-origin"});fetch(u).then(s.handleRequestResponse).then(c).catch(()=>window.eZ.helpers.notification.showErrorNotification("Cannot load location"))}),t.loadContentInfo=(({token:e,siteaccess:t},i,l)=>{const o=i.join(),r=JSON.stringify({ViewInput:{identifier:`subitems-load-content-info-${o}`,public:!1,ContentQuery:{Criteria:{},FacetBuilders:{},SortClauses:{},Filter:{ContentIdCriterion:`${o}`},limit:i.length,offset:0}}}),c=new Request("/api/ezp/v2/views",{method:"POST",headers:a({},n,{"X-Siteaccess":t,"X-CSRF-Token":e}),body:r,mode:"cors",credentials:"same-origin"});fetch(c).then(s.handleRequestResponse).then(l).catch(()=>window.eZ.helpers.notification.showErrorNotification("Cannot load content info"))}),t.loadContentTypes=(({token:e,siteaccess:t},i)=>{const a=new Request("/api/ezp/v2/content/types",{method:"GET",headers:{Accept:"application/vnd.ez.api.ContentTypeInfoList+json","X-Siteaccess":t,"X-CSRF-Token":e},mode:"cors",credentials:"same-origin"});fetch(a).then(s.handleRequestResponse).then(i).catch(()=>window.eZ.helpers.notification.showErrorNotification("Cannot load content types"))}),t.loadContentType=((e,{token:t,siteaccess:i},a)=>{const n=new Request(e,{method:"GET",headers:{Accept:"application/vnd.ez.api.ContentType+json","X-Siteaccess":i,"X-CSRF-Token":t},mode:"cors",credentials:"same-origin"});fetch(n).then(s.handleRequestResponse).then(a).catch(()=>window.eZ.helpers.notification.showErrorNotification("Cannot load a content type"))}),t.updateLocationPriority=(({priority:e,location:t,token:i,siteaccess:a},n)=>{const l=new Request(t,{method:"POST",headers:{Accept:"application/vnd.ez.api.Location+json","Content-Type":"application/vnd.ez.api.LocationUpdate+json","X-Siteaccess":a,"X-CSRF-Token":i,"X-HTTP-Method-Override":"PATCH"},credentials:"same-origin",mode:"cors",body:JSON.stringify({LocationUpdate:{priority:e,sortField:"PATH",sortOrder:"ASC"}})});fetch(l).then(s.handleRequestResponse).then(n).catch(()=>window.eZ.helpers.notification.showErrorNotification("An error occurred while updating location priority"))})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bulkMoveLocationsToTrash=t.bulkMoveLocations=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},s=i(3);const n={Accept:"application/vnd.ez.api.BulkOperationResponse+json","Content-Type":"application/vnd.ez.api.BulkOperation+json"},l=t.bulkMoveLocations=((e,t,i,a)=>{const s=o(t,i);c(e,s,r.bind(null,t,a))}),o=(t.bulkMoveLocationsToTrash=((e,t,i)=>{l(e,t,"/api/ezp/v2/content/trash",i)}),(e,t)=>{const i={};return e.forEach(e=>{i[e.id]={uri:e._href,method:"MOVE",headers:{Destination:t}}}),i}),r=(e,t,i)=>{const a=i.BulkOperationResponse.operations,s=Object.entries(a).reduce((t,[i,a])=>{const s=e.find(e=>e.id===parseInt(i,10));return 200<=a.statusCode&&a.statusCode<=299?t.success.push(s):t.fail.push(s),t},{success:[],fail:[]});t(s.success,s.fail)},c=({token:e,siteaccess:t},i,l)=>{const o=new Request("/api/ezp/v2/bulk",{method:"POST",headers:a({},n,{"X-Siteaccess":t,"X-CSRF-Token":e}),body:JSON.stringify({bulkOperations:{operations:i}}),mode:"same-origin",credentials:"same-origin"});fetch(o).then(s.handleRequestResponse).then(l).catch(()=>{const e=Translator.trans("bulk_request.error.message",{},"sub_items");window.eZ.helpers.notification.showErrorNotification(e)})}}]).default});
//# sourceMappingURL=SubItems.module.js.map