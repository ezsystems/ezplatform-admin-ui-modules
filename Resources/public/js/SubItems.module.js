!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("prop-types")):"function"==typeof define&&define.amd?define(["react","prop-types"],t):"object"==typeof exports?exports.SubItems=t(require("react"),require("prop-types")):(e.eZ=e.eZ||{},e.eZ.modules=e.eZ.modules||{},e.eZ.modules.SubItems=t(e.React,e.PropTypes))}("undefined"!=typeof self?self:this,function(e,t){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=18)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var a=function(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}(i),r=i.sources.map(function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"});return[n].concat(r).concat([a]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},a=0;a<this.length;a++){var r=this[a][0];"number"==typeof r&&(i[r]=!0)}for(a=0;a<e.length;a++){var o=e[a];"number"==typeof o[0]&&i[o[0]]||(n&&!o[2]?o[2]=n:n&&(o[2]="("+o[2]+") and ("+n+")"),t.push(o))}},t}},function(e,t,n){var i={},a=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}}(function(){return window&&document&&document.all&&!window.atob}),r=function(e){var t={};return function(e){if("function"==typeof e)return e();if(void 0===t[e]){var n=function(e){return document.querySelector(e)}.call(this,e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),o=null,s=0,l=[],c=n(4);function d(e,t){for(var n=0;n<e.length;n++){var a=e[n],r=i[a.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](a.parts[o]);for(;o<a.parts.length;o++)r.parts.push(b(a.parts[o],t))}else{var s=[];for(o=0;o<a.parts.length;o++)s.push(b(a.parts[o],t));i[a.id]={id:a.id,refs:1,parts:s}}}}function u(e,t){for(var n=[],i={},a=0;a<e.length;a++){var r=e[a],o=t.base?r[0]+t.base:r[0],s={css:r[1],media:r[2],sourceMap:r[3]};i[o]?i[o].parts.push(s):n.push(i[o]={id:o,parts:[s]})}return n}function p(e,t){var n=r(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=l[l.length-1];if("top"===e.insertAt)i?i.nextSibling?n.insertBefore(t,i.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),l.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var a=r(e.insertInto+" "+e.insertAt.before);n.insertBefore(t,a)}}function f(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=l.indexOf(e);t>=0&&l.splice(t,1)}function m(e){var t=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),h(t,e.attrs),p(e,t),t}function h(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function b(e,t){var n,i,a,r;if(t.transform&&e.css){if(!(r=t.transform(e.css)))return function(){};e.css=r}if(t.singleton){var l=s++;n=o||(o=m(t)),i=_.bind(null,n,l,!1),a=_.bind(null,n,l,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",h(t,e.attrs),p(e,t),t}(t),i=function(e,t,n){var i=n.css,a=n.sourceMap,r=void 0===t.convertToAbsoluteUrls&&a;(t.convertToAbsoluteUrls||r)&&(i=c(i));a&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var o=new Blob([i],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(o),s&&URL.revokeObjectURL(s)}.bind(null,n,t),a=function(){f(n),n.href&&URL.revokeObjectURL(n.href)}):(n=m(t),i=function(e,t){var n=t.css,i=t.media;i&&e.setAttribute("media",i);if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),a=function(){f(n)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else a()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=u(e,t);return d(n,t),function(e){for(var a=[],r=0;r<n.length;r++){var o=n[r];(s=i[o.id]).refs--,a.push(s)}e&&d(u(e,t),t);for(r=0;r<a.length;r++){var s;if(0===(s=a[r]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete i[s.id]}}}};var v=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}();function _(e,t,n,i){var a=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=v(t,a);else{var r=document.createTextNode(a),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(r,o[t]):e.appendChild(r)}}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,i=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var a,r=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(r)?e:(a=0===r.indexOf("//")?r:0===r.indexOf("/")?n+r:i+r.replace(/^\.\//,""),"url("+JSON.stringify(a)+")")})}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&e.__esModule?e:{default:e}}(n(0));n(28);t.default=(()=>{const e=Translator.trans("no_items.message",{},"sub_items");return i.default.createElement("div",{className:"c-no-items"},e)})},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},a=n(0),r=u(a),o=u(n(1)),s=u(n(19)),l=u(n(23)),c=u(n(40)),d=n(43);function u(e){return e&&e.__esModule?e:{default:e}}n(44);class p extends a.Component{constructor(e){super(e),this.afterPriorityUpdated=this.afterPriorityUpdated.bind(this),this.loadContentItems=this.loadContentItems.bind(this),this.loadContentTypes=this.loadContentTypes.bind(this),this.updateItemsState=this.updateItemsState.bind(this),this.handleLoadMore=this.handleLoadMore.bind(this),this.switchView=this.switchView.bind(this),this.handleItemPriorityUpdate=this.handleItemPriorityUpdate.bind(this),this.state={activeView:e.activeView,items:e.items,contentTypesMap:e.contentTypesMap,totalCount:e.totalCount,offset:e.offset,isLoading:!1}}componentDidUpdate(e,t){t.offset<this.state.offset&&this.loadItems()}UNSAFE_componentWillReceiveProps(e){this.setState(t=>({items:[...t.items,...e.items]}))}handleLoadMore(){this.setState(e=>({offset:e.offset+this.props.limit}))}loadItems(){const e=this.props.parentLocationId;this.setState(()=>({isLoading:!0})),this.loadLocation(e).then(this.loadContentItems).then(this.loadContentTypes).then(this.updateItemsState).catch(()=>window.eZ.helpers.notification.showErrorNotification("An error occurred while loading items in the Sub Items module"))}loadLocation(e){var t=this.props;const n=t.limit,i=t.sortClauses,a=t.loadLocation,r=t.restInfo,o={locationId:e,limit:n,sortClauses:i,offset:this.state.offset};return new Promise(e=>a(r,o,e))}loadContentItems(e){var t=this.props;const n=t.loadContentInfo,i=t.restInfo;if(!e||!e.View){const e=Translator.trans("load_content_items.invalid_response_format.error.message",{},"sub_items");throw new Error(e)}const a=e.View.Result.searchHits.searchHit,r=[];return r.push(new Promise(e=>{const t=a.map(e=>e.value.Location.ContentInfo.Content._id);n(i,t,e)}).then(t=>({locations:a,totalCount:e.View.Result.count,content:t.View.Result.searchHits.searchHit}))),Promise.all(r)}loadContentTypes(e){const t=e[0].content.reduce((e,t)=>[...e,new Promise(e=>{const n=t.value.Content.ContentType._href;this.state.contentTypesMap[n]?e({ContentType:this.state.contentTypesMap[n]}):this.props.loadContentType(n,this.props.restInfo,t=>e(t))})],[]);return Promise.all(t).then(t=>(e[0].contentTypes=t,e[0]))}updateItemsState({locations:e,content:t,totalCount:n,contentTypes:i}){const a=e.reduce((e,n)=>{const i=n.value.Location;return[...e,{location:i,content:t.find(e=>e.value.Content._id===i.ContentInfo.Content._id).value.Content}]},[]);this.setState(e=>({items:[...e.items,...a],isLoading:!1,totalCount:n,contentTypesMap:this.buildContentTypesMap(i)}))}buildContentTypesMap(e){return e?e.reduce((e,t)=>(e[t.ContentType._href]=t.ContentType,e),{}):{}}handleItemPriorityUpdate(e){this.props.updateLocationPriority(i({},e,this.props.restInfo),this.afterPriorityUpdated)}afterPriorityUpdated(e){this.setState(this.updateItemsOrder.bind(this,e.Location))}updateItemsOrder(e,t){const n=t.items;return n.find(t=>t.location.id===e.id).location=e,n.sort((e,t)=>e.location.priority-t.location.priority),{items:n}}switchView(e){this.setState(()=>({activeView:e}))}renderExtraActions(e,t){const n=e.component;return r.default.createElement(n,i({key:t,className:"m-sub-items__action"},e.attrs))}renderLoadMore(){if(this.state.totalCount)return r.default.createElement(c.default,{totalCount:this.state.totalCount,loadedCount:this.state.items.length,limit:this.state.limit,onLoadMore:this.handleLoadMore})}render(){let e="m-sub-items__list";this.state.isLoading&&(e=`${e} ${e}--loading`);const t=Translator.trans("items_list.title",{},"sub_items");return r.default.createElement("div",{className:"m-sub-items"},r.default.createElement("div",{className:"m-sub-items__header"},r.default.createElement("div",{className:"m-sub-items__title"},t," (",this.state.totalCount,")"),r.default.createElement("div",{className:"m-sub-items__actions"},this.props.extraActions.map(this.renderExtraActions)),r.default.createElement(s.default,{onViewChange:this.switchView,activeView:this.state.activeView,isDisabled:!this.state.items.length})),r.default.createElement("div",{className:e},r.default.createElement(l.default,{activeView:this.state.activeView,contentTypesMap:this.state.contentTypesMap,handleItemPriorityUpdate:this.handleItemPriorityUpdate,items:this.state.items,languages:this.props.languages,handleEditItem:this.props.handleEditItem,generateLink:this.props.generateLink})),this.renderLoadMore())}}t.default=p,p.propTypes={parentLocationId:o.default.number.isRequired,restInfo:o.default.shape({token:o.default.string.isRequired,siteaccess:o.default.string.isRequired}).isRequired,loadContentInfo:o.default.func,loadContentType:o.default.func,loadContentTypes:o.default.func,loadLocation:o.default.func,sortClauses:o.default.object,updateLocationPriority:o.default.func,activeView:o.default.string,extraActions:o.default.arrayOf(o.default.shape({component:o.default.func,attrs:o.default.object})),items:o.default.arrayOf(o.default.object),limit:o.default.number,offset:o.default.number,handleEditItem:o.default.func.isRequired,generateLink:o.default.func.isRequired,contentTypesMap:o.default.object,totalCount:o.default.number,languages:o.default.object},p.defaultProps={loadContentInfo:d.loadContentInfo,loadContentType:d.loadContentType,loadContentTypes:d.loadContentTypes,loadLocation:d.loadLocation,sortClauses:{},updateLocationPriority:d.updateLocationPriority,activeView:"table",extraActions:[],languages:window.eZ.adminUiConfig.languages,items:[],limit:parseInt(window.eZ.adminUiConfig.subItems.limit,10),offset:0,contentTypesMap:{},totalCount:0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(0)),a=o(n(1)),r=o(n(20));function o(e){return e&&e.__esModule?e:{default:e}}n(21);const s=({onViewChange:e,activeView:t,isDisabled:n})=>{let a="c-grid-switcher";n&&(a=`${a} ${a}--disabled`);const o=Translator.trans("switch_to_list_view.btn.label",{},"sub_items"),s=Translator.trans("switch_to_grid_view.btn.label",{},"sub_items");return i.default.createElement("div",{className:a},i.default.createElement(r.default,{id:"table",icon:"view-list",title:o,onClick:e,activeView:t,isDisabled:n}),i.default.createElement(r.default,{id:"grid",icon:"view-grid",title:s,onClick:e,activeView:t,isDisabled:n}))};s.propTypes={onViewChange:a.default.func.isRequired,activeView:a.default.string.isRequired,isDisabled:a.default.bool.isRequired},t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0)),a=r(n(1));function r(e){return e&&e.__esModule?e:{default:e}}const o=({id:e,icon:t,title:n,onClick:a,activeView:r,isDisabled:o})=>{const s="c-grid-switcher__option",l={id:e,onClick:()=>a(e),className:s,title:n};return r===e&&(l.className=`${s} ${s}--active`),o&&(l.className=`${l.className} ${s}--disabled`),i.default.createElement("div",l,i.default.createElement("svg",{className:"ez-icon"},i.default.createElement("use",{xlinkHref:`/bundles/ezplatformadminui/img/ez-icons.svg#${t}`})))};o.propTypes={id:a.default.string.isRequired,activeView:a.default.string.isRequired,isDisabled:a.default.bool.isRequired,icon:a.default.string.isRequired,title:a.default.string.isRequired,onClick:a.default.func.isRequired},t.default=o},function(e,t,n){var i=n(22);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,a);i.locals&&(e.exports=i.locals)},function(e,t,n){(e.exports=n(2)(!1)).push([e.i,".c-grid-switcher,\n.c-grid-switcher * {\n    box-sizing: border-box;\n}\n\n.c-grid-switcher {\n    height: 40px;\n    width: 70px;\n    border: 3px solid #0e77a3;\n    border-radius: 4px;\n    display: flex;\n    overflow: hidden;\n    background: #fff;\n    box-shadow: inset 0 0 2px 0 rgba(26,53,71,0.4);\n    padding: 2px;\n}\n\n.c-grid-switcher__option {\n    flex: 1 1 30px;\n    max-width: 30px;\n    height: 30px;\n    padding: 0;\n    margin: 0;\n    border: 2px solid #fff;\n    background: #fff;\n    color: #0e77a3;\n    transition: all .1s ease-in-out;\n    display: flex;\n    justify-content: center;\n    cursor: pointer;\n}\n\n.c-grid-switcher__option:first-of-type {\n    border-radius: 2px 0 0 2px;\n}\n\n.c-grid-switcher__option:last-of-type {\n    border-radius: 0 2px 2px 0;\n}\n\n.c-grid-switcher__option--active {\n    background: #0e77a3;\n}\n\n.c-grid-switcher__option .ez-icon {\n    fill: #0e77a3;\n    margin: auto;\n    width: 18px;\n    height: 18px;\n}\n\n.c-grid-switcher__option--active .ez-icon {\n    fill: #fff;\n}\n\n.c-grid-switcher__option--disabled {\n    pointer-events: none;\n    opacity: .5;\n}\n\n.c-grid-switcher--disabled {\n    cursor: not-allowed;\n}\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(0)),a=s(n(1)),r=s(n(24)),o=s(n(32));function s(e){return e&&e.__esModule?e:{default:e}}n(38);const l={table:r.default,grid:o.default},c=e=>{const t=l[e.activeView];return i.default.createElement(t,e)};c.propTypes={activeView:a.default.string.isRequired,items:a.default.arrayOf(a.default.object),contentTypesMap:a.default.object.isRequired,handleItemPriorityUpdate:a.default.func.isRequired,languages:a.default.object.isRequired},t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},a=n(0),r=c(a),o=c(n(1)),s=c(n(25)),l=c(n(11));function c(e){return e&&e.__esModule?e:{default:e}}n(30);const d="name",u="date",p="priority";class f extends a.Component{constructor(e){super(e),this.sortByName=this.sortByName.bind(this),this.sortByDate=this.sortByDate.bind(this),this.sortByPriority=this.sortByPriority.bind(this),this.renderItem=this.renderItem.bind(this),this.state={items:e.items,isAscSort:!1,sortKey:!1}}UNSAFE_componentWillReceiveProps({items:e}){this.sortItems(e)}sortItems(e){const t=this.state.sortKey;t||this.setState(()=>({items:e})),t===d?this.sortByName(e):t===u?this.sortByDate(e):t===p?this.sortByPriority(e):this.setState(()=>({items:e}))}sortByName(e){this.setState(t=>{const n=!Array.isArray(e),i=n?!t.isAscSort:t.isAscSort;return(e=n?t.items:e).sort((e,t)=>i?e.content.Name.localeCompare(t.content.Name):t.content.Name.localeCompare(e.content.Name)),{items:e,isAscSort:i,sortKey:d}})}sortByDate(e){this.setState(t=>{const n=!Array.isArray(e),i=n?!t.isAscSort:t.isAscSort;return(e=n?t.items:e).sort((e,t)=>i?new Date(e.content.lastModificationDate)-new Date(t.content.lastModificationDate):new Date(t.content.lastModificationDate)-new Date(e.content.lastModificationDate)),{items:e,isAscSort:i,sortKey:u}})}sortByPriority(e){this.setState(t=>{const n=!Array.isArray(e),i=n?!t.isAscSort:t.isAscSort;return(e=n?t.items:e).sort((e,t)=>i?e.location.priority-t.location.priority:t.location.priority-e.location.priority),{items:e,isAscSort:i,sortKey:p}})}renderItem(e){var t=this.props;const n=t.contentTypesMap,a=t.handleItemPriorityUpdate,o=t.handleEditItem,l=t.generateLink,c=t.languages;return r.default.createElement(s.default,i({key:e.location.id},e,{contentTypesMap:n,onItemPriorityUpdate:a,languages:c,handleEditItem:o,generateLink:l}))}renderNoItems(){return r.default.createElement("tr",null,r.default.createElement("td",null,r.default.createElement(l.default,null)))}renderHead(){const e="c-table-view__cell",t=`${e}--head`,n=`${e}--sortable`;let i="c-table-view__head";if(!this.props.items.length)return;if(this.state.sortKey){i=`${i} ${this.state.isAscSort?`${i}--sort-asc`:`${i}--sort-desc`} ${`${i}--sort-by-${this.state.sortKey}`}`}const a=Translator.trans("items_table.header.name",{},"sub_items"),o=Translator.trans("items_table.header.modified",{},"sub_items"),s=Translator.trans("items_table.header.content_type",{},"sub_items"),l=Translator.trans("items_table.header.priority",{},"sub_items"),c=Translator.trans("items_table.header.translations",{},"sub_items");return r.default.createElement("thead",{className:i},r.default.createElement("tr",{className:"c-table-view__row"},r.default.createElement("td",{className:`${t} ${e}--name ${n}`,onClick:this.sortByName},r.default.createElement("span",{className:"c-table-view__label"},a)),r.default.createElement("td",{className:`${t} ${e}--date ${n}`,onClick:this.sortByDate},r.default.createElement("span",{className:"c-table-view__label"},o)),r.default.createElement("td",{className:t},r.default.createElement("span",{className:"c-table-view__label"},s)),r.default.createElement("td",{className:`${t} ${e}--priority ${n}`,onClick:this.sortByPriority},r.default.createElement("span",{className:"c-table-view__label"},l)),r.default.createElement("td",{className:t,colSpan:"2"},r.default.createElement("span",{className:"c-table-view__label"},c))))}render(){const e=this.props.items,t=e.length?e.map(this.renderItem):this.renderNoItems();return r.default.createElement("table",{className:"c-table-view"},this.renderHead(),r.default.createElement("tbody",{className:"c-table-view__body"},t))}}t.default=f,f.propTypes={items:o.default.arrayOf(o.default.object).isRequired,contentTypesMap:o.default.object.isRequired,handleItemPriorityUpdate:o.default.func.isRequired,generateLink:o.default.func.isRequired,handleEditItem:o.default.func.isRequired,languages:o.default.object.isRequired}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},a=n(0),r=s(a),o=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}n(26);class l extends a.Component{constructor(e){super(e),this.storePriorityValue=this.storePriorityValue.bind(this),this.enablePriorityInput=this.enablePriorityInput.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleEdit=this.handleEdit.bind(this),this.state={priorityValue:e.location.priority,priorityInputEnabled:!1,startingPriorityValue:e.location.priority}}shouldComponentUpdate(e,t){return this.state.priorityInputEnabled!==t.priorityInputEnabled}enablePriorityInput(){this.setState(()=>({priorityInputEnabled:!0}))}handleCancel(e){e.preventDefault(),this.setState(e=>({priorityInputEnabled:!1,priorityValue:e.startingPriorityValue}))}handleSubmit(e){e.preventDefault(),this.props.onItemPriorityUpdate({location:this.props.location._href,priority:this._refPriorityInput.value}),this.setState(()=>({priorityValue:this._refPriorityInput.value,priorityInputEnabled:!1,startingPriorityValue:this._refPriorityInput.value}))}storePriorityValue(e){e.preventDefault(),this.setState(()=>({priorityValue:this._refPriorityInput.value}))}handleEdit(){this.props.handleEditItem(this.props.content)}renderPriorityCell(){const e={type:"number",defaultValue:this.state.priorityValue,onChange:this.storePriorityValue},t={},n={};return this.state.priorityInputEnabled||(e.disabled=!0,e.value=this.state.priorityValue,t.onClick=this.enablePriorityInput,t.className="c-table-view-item__inner-wrapper--disabled",n.hidden=!0),r.default.createElement("td",{className:"c-table-view-item__cell--priority"},r.default.createElement("div",i({className:"c-table-view-item__priority-wrapper"},t),r.default.createElement("div",{className:"c-table-view-item__inner-wrapper c-table-view-item__inner-wrapper--input"},r.default.createElement("input",i({className:"c-table-view-item__priority-value",ref:e=>this._refPriorityInput=e},e))),r.default.createElement("div",i({className:"c-table-view-item__priority-actions"},n),r.default.createElement("button",{className:"c-table-view-item__btn--submit",onClick:this.handleSubmit},r.default.createElement("svg",{className:"ez-icon"},r.default.createElement("use",{xlinkHref:"/bundles/ezplatformadminui/img/ez-icons.svg#checkmark"}))),r.default.createElement("button",{className:"c-table-view-item__btn--cancel",onClick:this.handleCancel},r.default.createElement("svg",{className:"ez-icon"},r.default.createElement("use",{xlinkHref:"/bundles/ezplatformadminui/img/ez-icons.svg#discard"}))))))}renderTranslation(e,t){return r.default.createElement("span",{key:t,className:"c-table-view-item__translation"},e)}render(){var e=this.props;const t=e.content,n=e.location,i=e.contentTypesMap,a=e.generateLink,o=e.languages,s=Translator.trans("content_type.not_available.label",{},"sub_items"),l=Translator.trans("edit_item_btn.label",{},"sub_items"),c=window.eZ.helpers.timezone.formatShortDateWithTimezone,d=i[t.ContentType._href],u=d?d.names.value[0]["#text"]:s,p={className:"c-table-view-item__link c-table-view-item__text-wrapper",title:t.Name,href:a(n.id)},f=t.CurrentVersion.Version.VersionInfo.VersionTranslationInfo.Language.map(e=>o.mappings[e.languageCode].name);return r.default.createElement("tr",{className:"c-table-view-item"},r.default.createElement("td",{className:"c-table-view-item__cell--name"},r.default.createElement("a",p,t.Name)),r.default.createElement("td",{className:"c-table-view-item__cell--modified"},r.default.createElement("div",{className:"c-table-view-item__text-wrapper"},c(new Date(t.lastModificationDate)))),r.default.createElement("td",{className:"c-table-view-item__cell--content-type"},r.default.createElement("div",{className:"c-table-view-item__text-wrapper"},u)),this.renderPriorityCell(),r.default.createElement("td",{className:"c-table-view-item__cell--translations"},f.map(this.renderTranslation)),r.default.createElement("td",{className:"c-table-view-item__cell--actions"},r.default.createElement("div",null,r.default.createElement("span",{title:l,onClick:this.handleEdit,className:"c-table-view-item__btn--edit"},r.default.createElement("div",{className:"c-table-view-item__btn-inner"},r.default.createElement("svg",{className:"ez-icon"},r.default.createElement("use",{xlinkHref:"/bundles/ezplatformadminui/img/ez-icons.svg#edit"})))))))}}t.default=l,l.propTypes={content:o.default.object.isRequired,location:o.default.object.isRequired,contentTypesMap:o.default.object.isRequired,onItemPriorityUpdate:o.default.func.isRequired,handleEditItem:o.default.func.isRequired,generateLink:o.default.func.isRequired,languages:o.default.object.isRequired}},function(e,t,n){var i=n(27);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,a);i.locals&&(e.exports=i.locals)},function(e,t,n){(e.exports=n(2)(!1)).push([e.i,'.c-table-view-item + .c-table-view-item {\n    border-top: 1px solid #a8c8d5;\n}\n\n[class*="c-table-view-item__cell--"] {\n    padding-left: 16px;\n    font-size: 14px;\n    line-height: 20px;\n}\n\n.c-table-view-item__cell--translations {\n    max-width: 100px;\n}\n\n.c-table-view-item__translation {\n    display: block;\n}\n\n.c-table-view-item__text-wrapper {\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\n}\n\n.c-table-view-item__cell--name .c-table-view-item__text-wrapper {\n    max-width: 260px;\n}\n\n.c-table-view-item__cell--modified .c-table-view-item__text-wrapper {\n    max-width: 190px;\n}\n\n.c-table-view-item__priority-wrapper {\n    position: relative;\n}\n\n.c-table-view-item__priority-actions {\n    position: absolute;\n    left: 7ch;\n    top: 2px;\n    width: 90px;\n}\n\n.c-table-view-item__inner-wrapper--input {\n    width: 7ch;\n}\n\n.c-table-view-item__inner-wrapper--disabled {\n    position: relative;\n}\n\n.c-table-view-item__inner-wrapper--disabled:before {\n    position: absolute;\n    z-index: 2;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    content: \'\';\n    display: block;\n}\n\n.c-table-view-item__priority-value {\n    max-width: 100%;\n    height: 40px;\n    border: 1px solid #b1d2e0;\n    margin: 2px 0;\n    padding: 0 10px;\n}\n\n.c-table-view-item__priority-value[disabled] {\n    border: 0 none;\n    background: transparent;\n    cursor: pointer;\n}\n\n[class*="c-table-view-item__btn--"] {\n    color: #fff;\n    border: 1px solid transparent;\n    height: 40px;\n    min-width: 40px;\n    padding: 7px 8px;\n    transition: background .3s ease-in-out;\n    cursor: pointer;\n}\n\n.c-table-view-item__btn--submit {\n    background: #106d95;\n}\n\n.c-table-view-item__btn--edit .c-table-view-item__btn-inner {\n    padding: 7px 14px;\n    height: 100%;\n    display: flex;\n    align-items: center;\n}\n\n.c-table-view-item__btn--submit:hover,\n.c-table-view-item__btn--submit:focus {\n    background: #093a50;\n}\n\n.c-table-view-item__btn--cancel {\n    background: #646464;\n}\n\n.c-table-view-item__btn--cancel:hover,\n.c-table-view-item__btn--cancel:focus {\n    background: #3e3e3e;\n}\n\n.c-table-view-item__btn--edit {\n    text-align: center;\n    cursor: pointer;\n    color: #fff;\n    display: inline-block;\n}\n\n.c-table-view-item .ez-icon {\n    width: 24px;\n    height: 24px;\n    fill: #f15a10;\n}\n\n.c-table-view-item__priority-actions .ez-icon {\n    fill: #fff;\n}\n\n.c-table-view-item__link {\n    display: block;\n    color: #0645ad;\n    text-decoration: none;\n    cursor: pointer;\n    transition: color .3s cubic-bezier(.25, .8, .25, 1);\n}\n\n.c-table-view-item__link:hover,\n.c-table-view-item__link:focus {\n    color: #032863;\n    text-decoration: underline;\n}\n',""])},function(e,t,n){var i=n(29);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,a);i.locals&&(e.exports=i.locals)},function(e,t,n){(e.exports=n(2)(!1)).push([e.i,".c-no-items {\n    padding: 0 32px;\n    font-style: italic;\n    color: #878787;\n}\n",""])},function(e,t,n){var i=n(31);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,a);i.locals&&(e.exports=i.locals)},function(e,t,n){(e.exports=n(2)(!1)).push([e.i,'.c-table-view {\n    border-collapse: collapse;\n    width: 100%;\n}\n\n.c-table-view__cell--head {\n    padding-left: 16px;\n    font-weight: 700;\n}\n\n.c-table-view__cell--head:last-of-type {\n    padding-right: 100px;\n}\n\n.c-table-view__cell--sortable {\n    cursor: pointer;\n}\n\n.c-table-view__label {\n    position: relative;\n    display: inline-block;\n}\n\n.c-table-view__label:after {\n    content: \'\';\n    width: 0;\n    height: 0;\n    position: absolute;\n    top: 50%;\n    right: 0;\n    transform: translate(200%, -50%);\n}\n\n.c-table-view__row {\n    border-bottom: 1px solid #a8c8d5;\n}\n\n.c-table-view__body [class*="c-table-view-item__cell--"]:nth-child(4) {\n    width: 80px;\n}\n\n.c-table-view__body [class*="c-table-view-item__cell--"]:nth-child(6) {\n    width: 100px;\n}\n\n.c-table-view__head--sort-by-name.c-table-view__head--sort-desc .c-table-view__cell--name .c-table-view__label:after,\n.c-table-view__head--sort-by-date.c-table-view__head--sort-desc .c-table-view__cell--date .c-table-view__label:after,\n.c-table-view__head--sort-by-priority.c-table-view__head--sort-desc .c-table-view__cell--priority .c-table-view__label:after {\n    border-left: 3px solid transparent;\n\tborder-right: 3px solid transparent;\n\tborder-top: 5px solid #333;\n}\n\n.c-table-view__head--sort-by-name.c-table-view__head--sort-asc .c-table-view__cell--name .c-table-view__label:after,\n.c-table-view__head--sort-by-date.c-table-view__head--sort-asc .c-table-view__cell--date .c-table-view__label:after,\n.c-table-view__head--sort-by-priority.c-table-view__head--sort-asc .c-table-view__cell--priority .c-table-view__label:after {\n    border-left: 3px solid transparent;\n\tborder-right: 3px solid transparent;\n    border-bottom: 5px solid #333;\n}\n\n.c-table-view__body .c-no-items {\n    padding-top: 7px;\n    padding-left: 39px;\n}\n',""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},a=l(n(0)),r=l(n(1)),o=l(n(33)),s=l(n(11));function l(e){return e&&e.__esModule?e:{default:e}}n(36);const c=e=>{const t=e.items,n=e.contentTypesMap,r=e.generateLink;return t.length?a.default.createElement("div",{className:"c-grid-view"},t.map(e=>a.default.createElement(o.default,i({key:e.location.id},e,{contentTypesMap:n,generateLink:r})))):a.default.createElement("div",{className:"c-grid-view"},a.default.createElement(s.default,null))};c.propTypes={items:r.default.arrayOf(r.default.object),contentTypesMap:r.default.object,generateLink:r.default.func.isRequired},t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0)),a=r(n(1));function r(e){return e&&e.__esModule?e:{default:e}}n(34);const o=e=>{const t=e.content,n=e.location,a=e.generateLink,r=t.CurrentVersion.Version.Fields.field.find(e=>"ezimage"===e.fieldTypeIdentifier),o=r&&r.fieldValue&&r.fieldValue.uri&&r.fieldValue.path;let s=i.default.createElement("div",{className:"c-grid-view-item__image c-grid-view-item__image--none"},i.default.createElement("svg",{className:"ez-icon"},i.default.createElement("use",{xlinkHref:"/bundles/ezplatformadminui/img/ez-icons.svg#file"}))),l="";return o&&(s=i.default.createElement("img",{className:"c-grid-view-item__image",src:r.fieldValue.uri,alt:`${r.fieldValue.path}`}),l=i.default.createElement("div",{className:"c-grid-view-item__content-type"},i.default.createElement("svg",{className:"ez-icon"},i.default.createElement("use",{xlinkHref:"/bundles/ezplatformadminui/img/ez-icons.svg#file"})))),i.default.createElement("a",{className:"c-grid-view-item",href:a(n.id)},l,i.default.createElement("div",{className:"c-grid-view-item__image-wrapper"},s),i.default.createElement("div",{className:"c-grid-view-item__title"},t.Name))};o.propTypes={content:a.default.object.isRequired,location:a.default.object.isRequired,contentTypesMap:a.default.object.isRequired,generateLink:a.default.func.isRequired},t.default=o},function(e,t,n){var i=n(35);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,a);i.locals&&(e.exports=i.locals)},function(e,t,n){(e.exports=n(2)(!1)).push([e.i,".c-grid-view-item {\n    cursor: pointer;\n    text-decoration: none;\n    transition: background .3s ease-in-out;\n    position: relative;\n    background: #f3f3f3;\n    border-radius: 4px;\n    margin-bottom: 8px;\n}\n\n.c-grid-view-item:hover,\n.c-grid-view-item:focus {\n    text-decoration: none;\n    background: #e5e3e3;\n}\n\n.c-grid-view-item__content-type {\n    position: absolute;\n    z-index: 2;\n    top: 0;\n    left: 0;\n    width: 30px;\n    height: 30px;\n    background: #fafafa;\n    border-radius: 4px 0 0 0;\n}\n\n.c-grid-view-item__content-type .ez-icon {\n    width: 16px;\n    height: 16px;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n}\n\n.c-grid-view-item__image {\n    display: block;\n    width: auto;\n    height: auto;\n    max-width: 166px;\n    max-height: 166px;\n    transition: border-color .3s ease-in-out;\n}\n\n.c-grid-view-item__image-wrapper {\n    height: 166px;\n    width: 166px;\n    border-radius: 4px 4px 0 0;\n    background-color: #e5e3e3;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.c-grid-view-item__image:hover {\n    border-color: #5c5c5c;\n}\n\n.c-grid-view-item__title {\n    word-break: break-all;\n    line-height: 20px;\n    padding: 10px 0;\n    font-size: 14px;\n    padding: 4px 8px;\n    color: #333;\n    font-weight: 700;\n}\n\n.c-grid-view-item__image--none .ez-icon {\n    width: 64px;\n    height: 64px;\n}\n",""])},function(e,t,n){var i=n(37);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,a);i.locals&&(e.exports=i.locals)},function(e,t,n){(e.exports=n(2)(!1)).push([e.i,".c-grid-view,\n.c-grid-view * {\n    box-sizing: border-box;\n}\n\n.c-grid-view {\n    display: flex;\n    flex-wrap: wrap;\n    padding-left: 8px;\n    padding-top: 8px;\n}\n\n.c-grid-view .c-grid-view-item {\n    flex: 1 1 calc(100% / 6);\n    max-width: 166px;\n    margin-right: 8px;\n}\n",""])},function(e,t,n){var i=n(39);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,a);i.locals&&(e.exports=i.locals)},function(e,t,n){(e.exports=n(2)(!1)).push([e.i,"",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},a=n(0),r=s(a),o=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}n(41);class l extends a.PureComponent{constructor(e){super(e),this._refLoadMore=null,this.loadMore=this.loadMore.bind(this),this.setLoadMoreRef=this.setLoadMoreRef.bind(this)}setLoadMoreRef(e){this._refLoadMore=e}loadMore(e){this._refLoadMore.hasAttribute("disabled")||this.props.onLoadMore(e)}render(){var e=this.props;const t=e.totalCount,n=e.loadedCount,a=e.limit,o={className:"c-load-more__btn--load",onClick:this.loadMore};(!t||n>=t)&&(o.disabled=!0);const s=Translator.trans("load_more.info.text",{loaded:n,total:t},"sub_items"),l=t-n,c=l>a?a:l,d=Translator.trans("load_more.action.text",{limit:c},"sub_items");return r.default.createElement("div",{className:"c-load-more"},r.default.createElement("div",{className:"c-load-more__message",dangerouslySetInnerHTML:{__html:s}}),r.default.createElement("div",i({},o,{ref:this.setLoadMoreRef}),d))}}t.default=l,l.propTypes={totalCount:o.default.number.isRequired,loadedCount:o.default.number.isRequired,limit:o.default.number.isRequired,onLoadMore:o.default.func.isRequired},l.defaultProps={totalCount:0,loadedCount:0}},function(e,t,n){var i=n(42);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,a);i.locals&&(e.exports=i.locals)},function(e,t,n){(e.exports=n(2)(!1)).push([e.i,".c-load-more {\n    text-align: center;\n}\n\n.c-load-more__message {\n    padding: 16px 0;\n    font-size: 12px;\n}\n\n.c-load-more__btn--load {\n    padding: 14px 28px;\n    border-radius: 4px;\n    text-align: center;\n    cursor: pointer;\n    letter-spacing: .5px;\n    border: 1px solid #0f6d95;\n    background-color: transparent;\n    color: #0f6d95;\n    font-size: 16px;\n    display: inline-block;\n    transition: background .3s ease-in-out;\n}\n\n.c-load-more__btn--load:hover,\n.c-load-more__btn--load:focus {\n    background: #0f6d95;\n    color: #fff;\n}\n\n.c-load-more__btn--load[disabled],\n.c-load-more__btn--load[disabled]:hover,\n.c-load-more__btn--load[disabled]:focus {\n    cursor: not-allowed;\n    opacity: .3\n}\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};const a={Accept:"application/vnd.ez.api.View+json; version=1.1","Content-Type":"application/vnd.ez.api.ViewInput+json; version=1.1"},r=e=>{if(!e.ok)throw Error(e.statusText);return e.json()};t.loadLocation=(({token:e,siteaccess:t},{locationId:n=2,limit:o=10,offset:s=0,sortClauses:l},c)=>{const d=JSON.stringify({ViewInput:{identifier:`subitems-load-location-${n}`,public:!1,LocationQuery:{Criteria:{},FacetBuilders:{},SortClauses:l,Filter:{ParentLocationIdCriterion:n},limit:o,offset:s}}}),u=new Request("/api/ezp/v2/views",{method:"POST",headers:i({},a,{"X-Siteaccess":t,"X-CSRF-Token":e}),body:d,mode:"cors",credentials:"same-origin"});fetch(u).then(r).then(c).catch(()=>window.eZ.helpers.notification.showErrorNotification("Cannot load location"))}),t.loadContentInfo=(({token:e,siteaccess:t},n,o)=>{const s=n.join(),l=JSON.stringify({ViewInput:{identifier:`subitems-load-content-info-${s}`,public:!1,ContentQuery:{Criteria:{},FacetBuilders:{},SortClauses:{},Filter:{ContentIdCriterion:`${s}`},limit:n.length,offset:0}}}),c=new Request("/api/ezp/v2/views",{method:"POST",headers:i({},a,{"X-Siteaccess":t,"X-CSRF-Token":e}),body:l,mode:"cors",credentials:"same-origin"});fetch(c).then(r).then(o).catch(()=>window.eZ.helpers.notification.showErrorNotification("Cannot load content info"))}),t.loadContentTypes=(({token:e,siteaccess:t},n)=>{const i=new Request("/api/ezp/v2/content/types",{method:"GET",headers:{Accept:"application/vnd.ez.api.ContentTypeInfoList+json","X-Siteaccess":t,"X-CSRF-Token":e},mode:"cors",credentials:"same-origin"});fetch(i).then(r).then(n).catch(()=>window.eZ.helpers.notification.showErrorNotification("Cannot load content types"))}),t.loadContentType=((e,{token:t,siteaccess:n},i)=>{const a=new Request(e,{method:"GET",headers:{Accept:"application/vnd.ez.api.ContentType+json","X-Siteaccess":n,"X-CSRF-Token":t},mode:"cors",credentials:"same-origin"});fetch(a).then(r).then(i).catch(()=>window.eZ.helpers.notification.showErrorNotification("Cannot load a content type"))}),t.updateLocationPriority=(({priority:e,location:t,token:n,siteaccess:i},a)=>{const o=new Request(t,{method:"POST",headers:{Accept:"application/vnd.ez.api.Location+json","Content-Type":"application/vnd.ez.api.LocationUpdate+json","X-Siteaccess":i,"X-CSRF-Token":n,"X-HTTP-Method-Override":"PATCH"},credentials:"same-origin",mode:"cors",body:JSON.stringify({LocationUpdate:{priority:e,sortField:"PATH",sortOrder:"ASC"}})});fetch(o).then(r).then(a).catch(()=>window.eZ.helpers.notification.showErrorNotification("An error occurred while updating location priority"))})},function(e,t,n){var i=n(45);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,a);i.locals&&(e.exports=i.locals)},function(e,t,n){(e.exports=n(2)(!1)).push([e.i,".m-sub-items,\n.m-sub-items * {\n    box-sizing: border-box;\n}\n\n.m-sub-items {\n    color: #333;\n}\n\n.m-sub-items__header {\n    height: 50px;\n    width: 100%;\n    border-radius: 4px 4px 0 0;\n    font-weight: 700;\n    line-height: 50px;\n    background-color: #445a64;\n    display: flex;\n    flex-wrap: nowrap;\n    justify-content: space-between;\n    padding: 0 16px;\n    align-items: center;\n}\n\n.m-sub-items__title {\n    font-size: 17px;\n    color: #fff;\n    flex: 1 1 auto;\n}\n\n.m-sub-items__actions .m-mfu {\n    height: 40px;\n    margin-right: 16px;\n}\n\n.m-sub-items__list {\n    background: #fff;\n    font-size: 15px;\n    line-height: 40px;\n    text-align: left;\n    position: relative;\n}\n\n.m-sub-items__list--loading:after {\n    content: '';\n    position: absolute;\n    z-index: 999;\n    background: rgba(0,0,0,.5);\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n",""])}]).default});
//# sourceMappingURL=SubItems.module.js.map